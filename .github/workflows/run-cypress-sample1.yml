name: Disabled - Cypress Tests with Slack Notification

run-name: "Cypress run for sample1 test on ${{ github.ref }} by ${{ github.actor }}"

on:
  push:
    branches:
      - main
  schedule:
    #This cron will never run (Feb 30th does not exist)
    - cron: '0 0 30 2 *'

jobs:
  sample1-run:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
      - name: Install dependencies
        run: npm ci
      - name: Run Sample1 Cypress test
        env:
          TERM: dumb
        run: |
          npx cypress run \
          --spec cypress/e2e/sample1.cy.ts \
          --headed --browser chrome
      - name: Notify Slack - Failure
        if: failure()
        uses: slackapi/slack-github-action@v1.23.0
        with:
          payload: |
            {
              "channel": "#notify-cypress-test-result",
              "username": "github-actions",
              "text": "The sample1 has an error. :x: Check the results here: <https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}|View Workflow Run>",
              "icon_emoji": ":x:"
            }
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK }}
      - name: Notify Slack - Success
        if: success()
        uses: slackapi/slack-github-action@v1.23.0
        with:
          payload: |
            {
              "channel": "#notify-cypress-test-result",
              "username": "github-actions",
              "text": "The sample1 is successful. :white_check_mark: Check the results here: <https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}|View Workflow Run>",
              "icon_emoji": ":white_check_mark:"
            }
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK }}
